(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"4hyD":function(e,t,a){"use strict";var n={name:"addCategory",data:function(){return{category:""}},methods:{show:function(){this.$modal.show("add-category")},storeCategory:function(){var e=this;this.$validator.validateAll().then((function(t){t?(e.$vs.loading(),e.$store.dispatch("storeCategory",{name:e.category}).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField()):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.category=""}}},i=a("KHd+"),s=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{height:"auto",scrollable:!0,pivotY:.2,clickToClose:!1,name:"add-category"}},[a("div",{staticClass:"flex justify-end"},[a("i",{staticClass:"vs-icon vs-popup--close material-icons text-warning",staticStyle:{background:"rgb(255, 255, 255)"},on:{click:function(t){return e.$modal.hide("add-category")}}},[e._v("close")])]),e._v(" "),a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"vx-row mb-10"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{"label-placeholder":"ឈ្មោះ",name:"category"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.storeCategory(t)}},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("category"),expression:"errors.has('category')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("category")))])],1)])],1)}),[],!1,null,"b31718a8",null);t.a=s.exports},"9Dpo":function(e,t,a){"use strict";var n={name:"addBrand",data:function(){return{brand:""}},methods:{show:function(){this.$modal.show("add-brand")},storeBrand:function(){var e=this;this.$validator.validateAll().then((function(t){t?(e.$vs.loading(),e.$store.dispatch("storeBrand",{name:e.brand}).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField()):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.brand=""}}},i=a("KHd+"),s=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{height:"auto",scrollable:!0,pivotY:.2,clickToClose:!1,name:"add-brand"}},[a("div",{staticClass:"flex justify-end"},[a("i",{staticClass:"vs-icon vs-popup--close material-icons text-warning",staticStyle:{background:"rgb(255, 255, 255)"},on:{click:function(t){return e.$modal.hide("add-brand")}}},[e._v("close")])]),e._v(" "),a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"vx-row mb-10"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{"label-placeholder":"ឈ្មោះ",name:"brand"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.storeBrand(t)}},model:{value:e.brand,callback:function(t){e.brand=t},expression:"brand"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("brand"),expression:"errors.has('brand')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("brand")))])],1)])],1)}),[],!1,null,"1dd572a1",null);t.a=s.exports},B6Wq:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,"table[data-v-1adf321e], td[data-v-1adf321e], th[data-v-1adf321e] { color: #246ca8\n}[dir] table[data-v-1adf321e], [dir] td[data-v-1adf321e], [dir] th[data-v-1adf321e] {\n  border: 1px solid #246ca8\n}\ntable[data-v-1adf321e] {\n  border-collapse: collapse;\n  width: 100%;\n}\n[dir=ltr] th[data-v-1adf321e] { text-align: left;\n}\n[dir=rtl] th[data-v-1adf321e] {\n  text-align: right;\n}\n",""])},B6ir:function(e,t,a){"use strict";var n=a("ksP6"),i=a.n(n),s=(a("Hj/Q"),a("yo3J")),r=a("4hyD"),o={name:"addSupplier",components:{AddBrand:a("9Dpo").a,AddCategory:r.a,AddUnit:s.a,vueDropzone:i.a},data:function(){return{supplier:{name:null,company:null,contact:null,note:null,address:null}}},computed:{all_units:function(){return this.$store.getters.all_unit},all_categories:function(){return this.$store.getters.all_category},all_brands:function(){return this.$store.getters.all_brand}},methods:{show:function(){this.$modal.show("add-supplier")},storeSupplier:function(){var e=this;this.$validator.validateAll().then((function(t){t?(e.$vs.loading(),e.$store.dispatch("storeSupplier",e.supplier).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField()):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.product={name:"",description:"",unit:"ដំុ",category:"គ្រឿងក្រោម",brand:"AKA",inventory_type:"inventory_part",purchase:1,sale:1,image:"placeholder/placeholder.png"}},successUpload:function(e,t){this.product.image=t.path}}},c=a("KHd+"),l=Object(c.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("modal",{attrs:{width:"60%",height:"auto",scrollable:!0,pivotY:.2,clickToClose:!1,name:"add-supplier"}},[a("div",{staticClass:"flex justify-end"},[a("i",{staticClass:"vs-icon vs-popup--close material-icons text-warning",staticStyle:{background:"rgb(255, 255, 255)"},on:{click:function(t){return e.$modal.hide("add-supplier")}}},[e._v("close")])]),e._v(" "),a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-2/3 w-full"},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{"label-placeholder":"ឈ្មោះ",name:"name"},model:{value:e.supplier.name,callback:function(t){e.$set(e.supplier,"name",t)},expression:"supplier.name"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("name"),expression:"errors.has('name')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("name")))])],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{"label-placeholder":"ឈ្មោះក្រុមហ៊ុន",name:"company"},model:{value:e.supplier.company,callback:function(t){e.$set(e.supplier,"company",t)},expression:"supplier.company"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("company"),expression:"errors.has('company')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("company")))])],1)]),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("label",[e._v("ទំនាក់ទំនង")]),e._v(" "),a("vs-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{label:"ទំនាក់ទំនង",name:"contact"},model:{value:e.supplier.contact,callback:function(t){e.$set(e.supplier,"contact",t)},expression:"supplier.contact"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("contact"),expression:"errors.has('contact')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("contact")))])],1),e._v(" "),a("div",{staticClass:"vx-col w-full"},[a("label",[e._v("សំគាល់")]),e._v(" "),a("vs-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{label:"សំគាល់",name:"note"},model:{value:e.supplier.note,callback:function(t){e.$set(e.supplier,"note",t)},expression:"supplier.note"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("note"),expression:"errors.has('note')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("note")))])],1)])]),e._v(" "),a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("អាស័យដ្ឋាន")]),e._v(" "),a("vs-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{label:"អាស័យដ្ឋាន",name:"address"},model:{value:e.supplier.address,callback:function(t){e.$set(e.supplier,"address",t)},expression:"supplier.address"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("address"),expression:"errors.has('address')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("address")))])],1)]),e._v(" "),a("vs-divider"),e._v(" "),a("div",{staticClass:"flex justify-end btn-group"},[a("vs-button",{attrs:{icon:"icon-save","icon-pack":"feather",type:"relief"},on:{click:e.storeSupplier}},[e._v("រក្សាទុក")])],1)],1)],1),e._v(" "),a("add-unit",{ref:"addUnit"}),e._v(" "),a("add-category",{ref:"addCategory"}),e._v(" "),a("add-brand",{ref:"addBrand"})],1)}),[],!1,null,"4ab12b82",null);t.a=l.exports},NHuT:function(e,t,a){var n=a("B6Wq");"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,i);n.locals&&(e.exports=n.locals)},VLXm:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,"[dir] table[data-v-de87b2a6], [dir] td[data-v-de87b2a6], [dir] th[data-v-de87b2a6] {\n  border: 1px solid black;\n}\ntable[data-v-de87b2a6] {\n  border-collapse: collapse;\n  width: 100%;\n}\n[dir=ltr] th[data-v-de87b2a6] {\n  text-align: left;\n}\n[dir=rtl] th[data-v-de87b2a6] {\n  text-align: right;\n}\n",""])},WsGf:function(e,t,a){"use strict";var n=a("NHuT");a.n(n).a},bsH6:function(e,t,a){"use strict";var n=a("i6E6");a.n(n).a},f3AR:function(e,t,a){"use strict";var n=a("o0o1"),i=a.n(n),s=a("w48C"),r=a.n(s),o=(a("K+Wz"),a("yo3J")),c=a("4hyD"),l=a("9Dpo"),d=a("B6ir"),v=a("Snq/"),u=a.n(v),p=a("q+Mi"),_=a("pS5H"),m=a("rdXg"),f=a.n(m);function h(e,t,a,n,i,s,r){try{var o=e[s](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}function b(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var s=e.apply(t,a);function r(e){h(s,n,i,r,o,"next",e)}function o(e){h(s,n,i,r,o,"throw",e)}r(void 0)}))}}var y,w,x={name:"showInvoice",components:{AddSupplier:d.a,AddBrand:l.a,AddCategory:c.a,AddUnit:o.a,flatPickr:r.a,"v-select":u.a,"bar-code":p.a,"money-format":_.a},data:function(){return{dialog:!1,data:{id:null,customer:{name:""},balance:null,due_balance:null,invoice_status:null,invoice_date:null,description:null,items:[]}}},computed:{total_amount:function(){return this.data.items.reduce((function(e,t){return e+parseFloat(t.amount)}),0)}},methods:{_print:(w=b(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelector("#printMe"),a={type:"dataURL"},e.next=4,this.$html2canvas(t,a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)}),printHtml:(y=b(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._print();case 2:t=e.sent,f()(t,"image");case 4:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)}),show:function(e){var t=this;this.dialog=!0,t.data.id=e.id,t.data.balance=e.balance,t.data.due_balance=e.due_balance,t.data.customer=e.customer,t.data.invoice_status=e.invoice_status,t.data.invoice_date=e.date,t.data.description=e.description,t.data.items=[],e.invoice_detail.forEach((function(e,a){t.data.items.push({name:e.purchase_detail.product.name,description:e.purchase_detail.product.description,qty:e.qty,sale_price:e.sale,amount:0})}))}}},g=(a("bsH6"),a("KHd+")),C=Object(g.a)(x,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("q-card",[a("q-bar",[a("q-space"),e._v(" "),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("Close")])],1)],1),e._v(" "),a("q-card-section",[a("vx-card",{attrs:{"no-shadow":""}},[a("div",{attrs:{id:"printMe"}},[a("table",[a("tr",[a("td",[e._v("អតិថិជន "),a("br"),e._v("Customer")]),e._v(" "),a("td",[e._v("Invoice Status")]),e._v(" "),a("td",[e._v("លក់ពី "),a("br"),e._v("Sold from")]),e._v(" "),a("td",[e._v("ពិពណ៌នា"),a("br"),e._v("Description")]),e._v(" "),a("td",[e._v("ថ្ងៃខែឆ្នាំលក់​ "),a("br"),e._v("Sold from")]),e._v(" "),a("td",[e._v("Barcode")])]),e._v(" "),a("tr",[a("td",[e._v("\n                                    ឈ្មោះ: "+e._s(e.data.customer.name)),a("br"),e._v("\n                                    ទំនាក់ទំនង: "+e._s(e.data.customer.contact)),a("br")]),e._v(" "),a("td",[e._v(e._s(e.data.invoice_status))]),e._v(" "),a("td",[e._v("Ly put")]),e._v(" "),a("td",[e._v(e._s(e.data.description))]),e._v(" "),a("td",[e._v(e._s(e.data.invoice_date))]),e._v(" "),a("td",{staticClass:"p-2"},[a("bar-code",{attrs:{value:"000"+e.data.id,options:{displayValue:!0,height:30}}})],1)])]),e._v(" "),a("vs-divider"),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("ល.រ "),a("br"),e._v("No")]),e._v(" "),a("th",[e._v("ឈ្មោះ"),a("br"),e._v("Name")]),e._v(" "),a("th",[e._v("ពិពណ៌នា"),a("br"),e._v("Description")]),e._v(" "),a("th",[e._v("ចំនួន"),a("br"),e._v("Qty")]),e._v(" "),a("th",[e._v("តម្លៃលក់"),a("br"),e._v("Unit Price")]),e._v(" "),a("th",[e._v("សរុប"),a("br"),e._v("Amount")])])]),e._v(" "),a("tbody",e._l(e.data.items,(function(t,n){return a("tr",{key:n},[a("td",{staticClass:"pl-2 print:pl-2"},[e._v("\n                                    "+e._s(n+1)+"\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[e._v("\n                                    "+e._s(t.name)+"\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[e._v("\n                                    "+e._s(t.description)+"\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[e._v("\n                                    "+e._s(t.qty)+"\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[a("money-format",{attrs:{value:parseFloat(t.sale_price),locale:"en","currency-code":"USD"}})],1),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[a("money-format",{attrs:{value:parseFloat(t.amount=t.sale_price*t.qty),locale:"en","currency-code":"USD"}})],1)])})),0),e._v(" "),a("tfoot",[a("tr",[a("td"),e._v(" "),a("td"),e._v(" "),a("td"),e._v(" "),a("td"),e._v(" "),a("td",{staticClass:"md:text-right"},[e._v("\n                                    សរុប\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[a("money-format",{attrs:{value:e.total_amount,locale:"en","currency-code":"USD"}})],1)])])]),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("vs-divider",{attrs:{position:"left"}},[e._v("Payment")]),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 print:w-1/2 w-full"},[a("label",[e._v("ប្រាក់ទិញទំនិញ")]),e._v(" "),a("money-format",{attrs:{value:parseFloat(e.data.balance),locale:"en","currency-code":"USD"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 print:w-1/2 w-full"},[a("label",[e._v("ទឹកប្រាក់ជំពាក់")]),e._v(" "),a("money-format",{attrs:{value:parseFloat(e.data.due_balance),locale:"en","currency-code":"USD"}})],1)])],1)])],1),e._v(" "),a("div",{staticClass:"flex justify-end btn-group"},[a("vs-button",{attrs:{icon:"icon-printer","icon-pack":"feather",type:"relief"},on:{click:e.printHtml}},[e._v("បោះពុម្ភ\n                        ")])],1)])],1)],1)],1),e._v(" "),a("add-supplier",{ref:"addSupplier"}),e._v(" "),a("add-unit",{ref:"addUnit"}),e._v(" "),a("add-category",{ref:"addCategory"}),e._v(" "),a("add-brand",{ref:"addBrand"})],1)}),[],!1,null,"de87b2a6",null);t.a=C.exports},g0IJ:function(e,t,a){"use strict";a.r(t);var n=a("o0o1"),i=a.n(n);function s(e,t,a,n,i,s,r){try{var o=e[s](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}var r={name:"addPayment",methods:{show:function(e){this.dialog=!0,this.data.id=e.id,this.data.balance=e.due_balance,this.data.input_balance=e.due_balance},updateInvoicePayment:function(){var e=this;this.$validator.validateAll().then((function(t){t?(e.$vs.loading(),e.$store.dispatch("updateInvoicePayment",e.data).then(function(){var t,a=(t=i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}return e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទឹកប្រាក់បានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),t.next=4,e.$store.dispatch("fetchInvoice");case 4:e.$emit("finished"),e.$modal.hide("add-payment"),t.next=9;break;case 8:e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទឹកប្រាក់មិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"});case 9:e.$vs.loading.close();case 10:case"end":return t.stop()}}),t)})),function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function o(e){s(r,n,i,o,c,"next",e)}function c(e){s(r,n,i,o,c,"throw",e)}o(void 0)}))});return function(e){return a.apply(this,arguments)}}())):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))}},data:function(){return{dialog:!1,data:{id:null,balance:0,input_balance:0,due_balance:0}}},computed:{due_balance:function(){return this.data.due_balance=this.data.balance-this.data.input_balance}}},o=a("KHd+"),c=Object(o.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("q-card",[a("q-bar",[a("q-space"),e._v(" "),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("Close")])],1)],1),e._v(" "),a("q-card-section",[a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("h4",[e._v("ទឹកប្រាក់ត្រូវសង")]),e._v(" "),a("span",{staticClass:"text-2xl"},[e._v("$"+e._s(e.data.balance))])]),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("h4",[e._v("ទឹកប្រាក់នៅសល់")]),e._v(" "),a("span",{staticClass:"text-2xl"},[e._v("$"+e._s(e.due_balance))])])]),e._v(" "),a("vs-divider"),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("vs-input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{min:"0",max:e.data.balance,name:"input_balance"},model:{value:e.data.input_balance,callback:function(t){e.$set(e.data,"input_balance",t)},expression:"data.input_balance"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("input_balance"),expression:"errors.has('input_balance')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("input_balance")))])],1)]),e._v(" "),a("div",{staticClass:"flex justify-end btn-group"},[a("vs-button",{attrs:{icon:"icon-dollar-sign","icon-pack":"feather",type:"relief"},on:{click:e.updateInvoicePayment}},[e._v("ចំណាយ")])],1)],1)],1)],1)],1)}),[],!1,null,"a3cf036e",null).exports,l=a("f3AR"),d=a("w48C"),v=a.n(d),u=(a("K+Wz"),a("yo3J")),p=a("4hyD"),_=a("9Dpo"),m=a("Snq/"),f=a.n(m),h={name:"addCustomer",data:function(){return{data:{name:null,contact:null,note:null,address:null}}},methods:{show:function(){this.$modal.show("add-customer")},storeCustomer:function(){var e=this;this.$validator.validateAll().then((function(t){t?(e.$vs.loading(),e.$store.dispatch("storeCustomer",e.data).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField()):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.data={name:null,contact:null,note:null,address:null}}}},b=Object(o.a)(h,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("modal",{attrs:{width:"60%",height:"auto",scrollable:!0,pivotY:.2,clickToClose:!1,name:"add-customer"}},[a("div",{staticClass:"flex justify-end"},[a("i",{staticClass:"vs-icon vs-popup--close material-icons text-warning",staticStyle:{background:"rgb(255, 255, 255)"},on:{click:function(t){return e.$modal.hide("add-customer")}}},[e._v("close")])]),e._v(" "),a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-2/3 w-full"},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{"label-placeholder":"ឈ្មោះ",name:"name"},model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("name"),expression:"errors.has('name')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("name")))])],1)]),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col w-full"},[a("label",[e._v("ទំនាក់ទំនង")]),e._v(" "),a("vs-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{label:"ទំនាក់ទំនង",name:"contact"},model:{value:e.data.contact,callback:function(t){e.$set(e.data,"contact",t)},expression:"data.contact"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("contact"),expression:"errors.has('contact')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("contact")))])],1),e._v(" "),a("div",{staticClass:"vx-col w-full"},[a("label",[e._v("សំគាល់")]),e._v(" "),a("vs-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{label:"សំគាល់",name:"note"},model:{value:e.data.note,callback:function(t){e.$set(e.data,"note",t)},expression:"data.note"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("note"),expression:"errors.has('note')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("note")))])],1)])]),e._v(" "),a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("អាស័យដ្ឋាន")]),e._v(" "),a("vs-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{label:"អាស័យដ្ឋាន",name:"address"},model:{value:e.data.address,callback:function(t){e.$set(e.data,"address",t)},expression:"data.address"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("address"),expression:"errors.has('address')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("address")))])],1)]),e._v(" "),a("vs-divider"),e._v(" "),a("div",{staticClass:"flex justify-end btn-group"},[a("vs-button",{attrs:{icon:"icon-save","icon-pack":"feather",type:"relief"},on:{click:e.storeCustomer}},[e._v("រក្សាទុក")])],1)],1)],1)],1)}),[],!1,null,"249ed636",null).exports;function y(e,t,a,n,i,s,r){try{var o=e[s](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function x(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var g,C,k={name:"addInvoice",components:{AddCustomer:b,AddBrand:_.a,AddCategory:p.a,AddUnit:u.a,flatPickr:v.a,"v-select":f.a},data:function(){return{dialog:!1,options:[],invoice:{is_bundle:!1,purchase_amount:0,sale_amount:0,customer:null,user_id:this.$store.state.AppActiveUser.uid,invoice_date:null,invoice_status:"pending",description:"",total_balance:null,balance:null,due_balance:0,amount:0,qty:0,items:[]}}},computed:{all_customer:function(){return this.$store.getters.all_customer},all_purchase_details:function(){return this.$store.getters.all_purchase_detail.sort((function(e,t){return e.product.id>t.product.id?1:-1}))},filtered_purchase_details:function(){return this.all_purchase_details.filter((function(e){return"purchase_only"!==e.inventory_type}))},map_all_products:function(){return this.filtered_purchase_details.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(a,!0).forEach((function(t){x(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({label:"ID: ".concat(e.product.id," - ").concat(e.product.name," (តម្លៃលក់ ").concat(e.sale,")"),value:e.product.id},e)}))},total:function(){var e=0;return this.invoice.items.forEach((function(t,a){e+=parseFloat(t.amount)})),this.invoice.is_bundle?(this.invoice.total_balance=this.invoice.sale_amount,this.invoice.balance=this.invoice.sale_amount):(this.invoice.total_balance=e,this.invoice.balance=e),e},total_qty:function(){var e=0;return this.invoice.items.forEach((function(t,a){e+=parseFloat(t.qty)})),this.invoice.qty=e,e}},updated:function(){this.total_qty,this.total},destroyed:function(){this.$barcodeScanner.destroy()},methods:{filterFn:function(e,t){var a=this;t(""!==e?function(){var t=e.toLowerCase();a.options=a.map_all_products.filter((function(e){return String(e.value).toLowerCase().indexOf(t)>-1}))}:function(){a.options=a.map_all_products})},onBarcodeScanned:function(e){this.addItemLine()},searchCustomer:function(e,t,a){return String(t).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.note).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.contact).toLowerCase().indexOf(a.toLowerCase())>-1},searchProduct:function(e,t,a){return String(e.product.id).toLowerCase().indexOf(a.toLowerCase())>-1},addItemLine:function(){this.invoice.items.push({id:"",name:null,description:null,qty:1,sale_price:1,amount:1,inventory_type:"",remain_qty:""})},removeItemLine:function(e){this.invoice.items.splice(e,1)},selectProduct:function(e,t){e&&(this.invoice.items[t].name=e.product.name,this.invoice.items[t].id={id:e.id,name:"".concat(e.product.name),product:{name:"ID: ".concat(e.product.id,"-").concat(e.product.name)},purchase:e.purchase,label:"ID: ".concat(e.product.id," - ").concat(e.product.name," (តម្លៃលក់ ").concat(e.sale,")"),value:e.product.id},this.invoice.items[t].inventory_type=e.inventory_type,this.invoice.items[t].remain_qty=parseFloat(e.remain_qty),this.invoice.items[t].description=e.product.description,this.invoice.items[t].sale_price=e.sale)},show:function(){this.dialog=!0,this.invoice.items=[],this.$barcodeScanner.init(this.onBarcodeScanned)},storeInvoice:function(){var e=this;this.$validator.validateAll().then((function(t){t?(e.$vs.loading(),e.$store.dispatch("storeInvoice",e.invoice).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField()):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.invoice={is_bundle:!1,purchase_amount:0,sale_amount:0,customer:null,user_id:this.$store.state.AppActiveUser.uid,invoice_date:null,invoice_status:"pending",description:"",total_balance:null,balance:null,due_balance:0,amount:0,qty:0,items:[{id:"",name:null,description:null,qty:1,sale_price:1,amount:1,inventory_type:"",remain_qty:""}]},this.$modal.hide("add-invoice")},successUpload:function(e,t){this.product.image=t.path}},created:(g=i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,t.$store.dispatch("fetchPurchaseDetail");case 3:case"end":return e.stop()}}),e,this)})),C=function(){var e=this,t=arguments;return new Promise((function(a,n){var i=g.apply(e,t);function s(e){y(i,a,n,s,r,"next",e)}function r(e){y(i,a,n,s,r,"throw",e)}s(void 0)}))},function(){return C.apply(this,arguments)})},q=Object(o.a)(k,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("q-card",[a("q-bar",[a("q-space"),e._v(" "),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("\n                        Close\n                    ")])],1)],1),e._v(" "),a("q-card-section",[a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"vx-row my-3"},[a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("អតិថិជន")]),e._v(" "),a("vx-input-group",[a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{filterBy:e.searchCustomer,label:"name",name:"customer",options:e.all_customer},scopedSlots:e._u([{key:"option",fn:function(e){return[a("vs-list-item",{attrs:{title:"ឈ្មោះ​ "+e.name,subtitle:"ទំនាក់ទំនង "+e.contact+" អាស័យដ្ឋាន "+e.address}})]}}]),model:{value:e.invoice.customer,callback:function(t){e.$set(e.invoice,"customer",t)},expression:"invoice.customer"}}),e._v(" "),a("template",{slot:"append"},[a("div",{staticClass:"append-text btn-addon",on:{click:function(t){return e.$refs.addCustomer.show()}}},[a("vs-button",{staticClass:"rounded-none",attrs:{type:"filled","icon-pack":"feather",icon:"icon-plus"}})],1)])],2),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("customer"),expression:"errors.has('customer')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("customer")))])],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("ថ្ងៃខែឆ្នាំទិញ")]),e._v(" "),a("flat-pickr",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{name:"invoice_date",placeholder:"Choose Date"},model:{value:e.invoice.invoice_date,callback:function(t){e.$set(e.invoice,"invoice_date",t)},expression:"invoice.invoice_date"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("invoice_date"),expression:"errors.has('invoice_date')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("invoice_date")))])],1)]),e._v(" "),a("div",{staticClass:"vx-row my-3"},[a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("Invoice\n                                Status")]),e._v(" "),a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{name:"invoice_status",options:["received","pending"]},model:{value:e.invoice.invoice_status,callback:function(t){e.$set(e.invoice,"invoice_status",t)},expression:"invoice.invoice_status"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("status"),expression:"errors.has('status')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("status")))])],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("ពិពណ៌នា")]),e._v(" "),a("vs-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{label:"ពិពណ៌នា",name:"description"},model:{value:e.invoice.description,callback:function(t){e.$set(e.invoice,"description",t)},expression:"invoice.description"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("description"),expression:"errors.has('description')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("description")))])],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/3"},[e._v("\n                            Amount\n                            "),a("span",{staticClass:"text-6xl block"},[e._v("$"+e._s(e.invoice.total_balance))])])]),e._v(" "),a("vs-divider",{attrs:{position:"left"}},[e._v("\n                        បញ្ជីទំនិញ\n                    ")]),e._v(" "),a("table",{staticClass:"vs-table vs-table--tbody-table"},[a("thead",[a("tr",[a("th",[e._v("\n                                ល.រ\n                            ")]),e._v(" "),a("th",[e._v("\n                                ឈ្មោះ\n                            ")]),e._v(" "),a("th",[e._v("\n                                ពិពណ៌នា\n                            ")]),e._v(" "),a("th",[e._v("\n                                ចំនួន\n                            ")]),e._v(" "),a("th",[e._v("\n                                តម្លៃលក់\n                            ")]),e._v(" "),a("th",[e._v("\n                                សរុប\n                            ")]),e._v(" "),a("th")])]),e._v(" "),a("tbody",e._l(e.invoice.items,(function(t,n){return a("tr",{key:n},[a("td",{staticClass:"py-1"},[e._v("\n                                "+e._s(n+1)+"\n                            ")]),e._v(" "),a("td",{attrs:{width:"600"}},[a("q-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{outlined:"",square:"",dense:"","use-input":"","input-debounce":"0",label:"ជ្រើសរើសទំនិញ",options:Object.freeze(e.options),behavior:"dialog",name:"product-"+n,clearable:""},on:{filter:e.filterFn,input:function(a){return e.selectProduct(t.id,n)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n                                                No results\n                                            ")])],1)]},proxy:!0},{key:"option",fn:function(t){return[a("q-item",e._g(e._b({},"q-item",t.itemProps,!1),t.itemEvents),[a("q-item-section",[a("q-item-label",{domProps:{innerHTML:e._s(t.opt.label)}}),e._v(" "),a("q-item-label",{attrs:{caption:""}},[e._v("\n                                                    "+e._s("Unit: "+t.opt.product.unit+" - Brand: "+t.opt.product.brand+" - Inventory Type: "+t.opt.inventory_type)+"\n                                                ")]),e._v(" "),a("q-item-label",[e._v("\n                                                    "+e._s("អ្នកផ្គត់ផ្គង់៖ "+t.opt.supplier.name+" ក្រុមហ៊ុន៖ "+t.opt.supplier.company)+"\n                                                ")]),e._v(" "),a("q-item-label",{attrs:{caption:""}},[e._v("\n                                                    "+e._s("ទំនាក់ទំនង "+t.opt.supplier.contact)+"\n                                                ")])],1)],1),e._v(" "),a("q-separator")]}}],null,!0),model:{value:t.id,callback:function(a){e.$set(t,"id",a)},expression:"tr.id"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("product-"+n),expression:"errors.has(`product-${index}`)"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("product-"+n)))])],1),e._v(" "),a("td",[e._v("\n                                "+e._s(t.description)+"\n                            ")]),e._v(" "),a("td",["service"===t.inventory_type?a("vs-input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{color:"danger",min:"0",name:"qty-"+n},model:{value:t.qty,callback:function(a){e.$set(t,"qty",a)},expression:"tr.qty"}}):e._e(),e._v(" "),"service"!==t.inventory_type?a("vs-input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{color:"success",min:"0",max:t.remain_qty,name:"qty-"+n},model:{value:t.qty,callback:function(a){e.$set(t,"qty",a)},expression:"tr.qty"}}):e._e(),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("qty-"+n),expression:"errors.has(`qty-${index}`)"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("qty-"+n)))])],1),e._v(" "),a("td",[a("vs-input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{color:"danger",min:"0",name:"sale_price-"+n},model:{value:t.sale_price,callback:function(a){e.$set(t,"sale_price",a)},expression:"tr.sale_price"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("sale_price-"+n),expression:"errors.has(`sale_price-${index}`)"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("sale_price-"+n)))])],1),e._v(" "),a("td",[e._v("\n                                "+e._s(t.amount=t.sale_price*t.qty)+"\n                            ")]),e._v(" "),a("td",{staticClass:"py-1"},[a("vs-button",{attrs:{icon:"icon-trash-2",color:"warning","icon-pack":"feather",type:"flat"},on:{click:function(t){return e.removeItemLine(n)}}})],1)])})),0)]),e._v(" "),a("vs-button",{staticClass:"rounded-none my-3",attrs:{icon:"icon-plus","icon-pack":"feather",type:"line"},on:{click:e.addItemLine}},[e._v("\n                        បន្ថែមទំនិញ\n                    ")]),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("vs-divider",{attrs:{position:"left"}},[e._v("\n                                Payment\n                            ")]),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("label",[e._v("ប្រាក់លក់ទំនិញ")]),e._v(" "),a("vs-input-number",{attrs:{color:"warning",min:"0",max:e.invoice.total_balance,label:"ប្រាក់លក់ទំនិញ:"},model:{value:e.invoice.balance,callback:function(t){e.$set(e.invoice,"balance",t)},expression:"invoice.balance"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("label",[e._v("ទឹកប្រាក់ជំពាក់")]),e._v(" "),a("vs-input",{staticClass:"w-full",attrs:{step:"any",readonly:"",type:"number"},model:{value:e.invoice.due_balance=e.invoice.total_balance-e.invoice.balance,callback:function(t){e.$set(e.invoice.due_balance=e.invoice.total_balance-e.invoice,"balance",t)},expression:"invoice.due_balance = invoice.total_balance - invoice.balance"}})],1)]),e._v(" "),a("vs-divider",{attrs:{position:"left"}},[a("vs-checkbox",{model:{value:e.invoice.is_bundle,callback:function(t){e.$set(e.invoice,"is_bundle",t)},expression:"invoice.is_bundle"}},[e._v("\n                                    ទំនិញដំុ?\n                                ")])],1),e._v(" "),e.invoice.is_bundle?a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("label",[e._v("តម្លៃទិញ")]),e._v(" "),a("vs-input-number",{attrs:{min:"0",label:"តម្លៃទិញ:"},model:{value:e.invoice.purchase_amount,callback:function(t){e.$set(e.invoice,"purchase_amount",t)},expression:"invoice.purchase_amount"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("label",[e._v("តម្លៃលក់")]),e._v(" "),a("vs-input-number",{attrs:{min:"0",label:"តម្លៃលក់:"},model:{value:e.invoice.sale_amount,callback:function(t){e.$set(e.invoice,"sale_amount",t)},expression:"invoice.sale_amount"}})],1)]):e._e()],1)]),e._v(" "),a("vs-divider"),e._v(" "),a("div",{staticClass:"flex justify-end btn-group"},[a("vs-button",{attrs:{icon:"icon-save","icon-pack":"feather",type:"relief"},on:{click:e.storeInvoice}},[e._v("\n                            រក្សាទុក\n                        ")])],1)],1)],1)],1)],1),e._v(" "),a("add-customer",{ref:"addCustomer"}),e._v(" "),a("add-unit",{ref:"addUnit"}),e._v(" "),a("add-category",{ref:"addCategory"}),e._v(" "),a("add-brand",{ref:"addBrand"})],1)}),[],!1,null,"991d8622",null).exports;function $(e,t,a,n,i,s,r){try{var o=e[s](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(a,!0).forEach((function(t){N(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var I={name:"editInvoice",components:{AddCustomer:b,AddBrand:_.a,AddCategory:p.a,AddUnit:u.a,flatPickr:v.a,"v-select":f.a},data:function(){return{dialog:!1,options:[],invoice:{id:null,is_bundle:!1,purchase_amount:0,sale_amount:0,customer:null,user_id:this.$store.state.AppActiveUser.uid,invoice_date:null,invoice_status:"pending",description:"",total_balance:null,balance:null,due_balance:0,old_due:0,amount:0,qty:0,items:[{id:"",name:null,description:null,qty:1,sale_price:1,amount:1,inventory_type:"",remain_qty:""}]}}},computed:{all_customer:function(){return this.$store.getters.all_customer},all_purchase_details:function(){return this.$store.getters.all_purchase_detail.map((function(e){return S({},e,{modified:!0})})).sort((function(e,t){return e.product.id>t.product.id?1:-1}))},map_all_products:function(){return this.all_purchase_details.map((function(e){return S({label:"ID: ".concat(e.product.id," - ").concat(e.product.name," (តម្លៃលក់ ").concat(e.sale,")"),value:e.product.id},e)}))},total:function(){var e=0;return this.invoice.items.forEach((function(t,a){e+=parseFloat(t.amount)})),this.invoice.is_bundle?(this.invoice.total_balance=this.invoice.sale_amount,this.invoice.balance=this.invoice.sale_amount-this.invoice.old_due):(this.invoice.total_balance=e,this.invoice.balance=e-this.invoice.old_due),e},total_qty:function(){var e=0;return this.invoice.items.forEach((function(t,a){e+=parseFloat(t.qty)})),this.invoice.qty=e,e}},updated:function(){this.total_qty,this.total},methods:{filterFn:function(e,t){var a=this;t(""!==e?function(){var t=e.toLowerCase();a.options=a.map_all_products.filter((function(e){return String(e.value).toLowerCase().indexOf(t)>-1}))}:function(){a.options=a.map_all_products})},onBarcodeScanned:function(e){this.addItemLine();var t=this.invoice.items.length-1;this.selectProduct({product_id:parseInt(e)},t)},searchCustomer:function(e,t,a){return String(t).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.note).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.contact).toLowerCase().indexOf(a.toLowerCase())>-1},searchProduct:function(e,t,a){return String(t).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.product.id).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.product.unit).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.product.brand).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.supplier.name).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.supplier.company).toLowerCase().indexOf(a.toLowerCase())>-1||String(e.supplier.contact).toLowerCase().indexOf(a.toLowerCase())>-1},addItemLine:function(){this.invoice.items.push({id:"",name:null,description:null,qty:1,sale_price:1,amount:1,inventory_type:"",remain_qty:""})},removeItemLine:function(e){this.invoice.items.splice(e,1)},selectProduct:function(e,t){e&&(this.invoice.items[t].name=e.product.name,this.invoice.items[t].id={id:e.id,name:"".concat(e.product.name),product:{name:"ID: ".concat(e.product.id,"-").concat(e.product.name)},purchase:e.purchase,label:"ID: ".concat(e.product.id," - ").concat(e.product.name," (តម្លៃលក់ ").concat(e.sale,")"),value:e.product.id},this.invoice.items[t].inventory_type=e.inventory_type,this.invoice.items[t].remain_qty=parseFloat(e.remain_qty),this.invoice.items[t].description=e.product.description,this.invoice.items[t].sale_price=e.sale)},show:function(e){var t=this;this.dialog=!0,t.$barcodeScanner.init(t.onBarcodeScanned),this.invoice.items=[],e.purchase_amount>0&&(t.invoice.is_bundle=!0,t.invoice.purchase_amount=e.purchase_amount,t.invoice.sale_amount=e.amount),t.invoice.id=e.id,t.invoice.customer=e.customer,t.invoice.invoice_date=e.date,t.invoice.invoice_status=e.invoice_status,t.invoice.description=e.description,t.invoice.old_due=e.due_balance,t.invoice.items=[],e.invoice_detail.sort((function(e,t){var a=e.purchase_detail.product_id,n=t.purchase_detail.product_id,i=0;return a>n?i=1:a<n&&(i=-1),i})),e.invoice_detail.forEach((function(e,a){t.invoice.items.push({id:{id:e.purchase_detail.id,name:"".concat(e.purchase_detail.product.name),product:{name:"ID: ".concat(e.purchase_detail.product_id,"-").concat(e.purchase_detail.product.name)},purchase:e.purchase_detail.purchase,label:"ID: ".concat(e.purchase_detail.product.id," - ").concat(e.purchase_detail.product.name," (តម្លៃលក់ ").concat(e.purchase_detail.sale,")"),value:e.purchase_detail.product.id},name:e.purchase_detail.product.name,description:e.purchase_detail.product.description,qty:e.qty,sale_price:e.sale,amount:e.amount,inventory_type:e.inventory_type,remain_qty:e.purchase_detail.remain_qty})}))},updateInvoice:function(){var e=this;this.$validator.validateAll().then((function(t){t?(e.$vs.loading(),e.$store.dispatch("updateInvoice",e.invoice).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.$emit("finished")):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close(),e.$modal.hide("edit-invoice")}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},successUpload:function(e,t){this.product.image=t.path}},created:function(){var e=function(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var s=e.apply(t,a);function r(e){$(s,n,i,r,o,"next",e)}function o(e){$(s,n,i,r,o,"throw",e)}r(void 0)}))}}(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,t.$store.dispatch("fetchPurchaseDetail");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},O=Object(o.a)(I,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("q-card",[a("q-bar",[a("q-space"),e._v(" "),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("Close")])],1)],1),e._v(" "),a("q-card-section",[a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"vx-row my-3"},[a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("អតិថិជន")]),e._v(" "),a("vx-input-group",[a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{filterBy:e.searchCustomer,label:"name",name:"customer",options:e.all_customer},scopedSlots:e._u([{key:"option",fn:function(e){return[a("vs-list-item",{attrs:{title:"ឈ្មោះ​ "+e.name,subtitle:"ទំនាក់ទំនង "+e.contact+" អាស័យដ្ឋាន "+e.address}})]}}]),model:{value:e.invoice.customer,callback:function(t){e.$set(e.invoice,"customer",t)},expression:"invoice.customer"}}),e._v(" "),a("template",{slot:"append"},[a("div",{staticClass:"append-text btn-addon",on:{click:function(t){return e.$refs.addCustomer.show()}}},[a("vs-button",{staticClass:"rounded-none",attrs:{type:"filled","icon-pack":"feather",icon:"icon-plus"}})],1)])],2),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("customer"),expression:"errors.has('customer')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("customer")))])],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("ថ្ងៃខែឆ្នាំទិញ")]),e._v(" "),a("flat-pickr",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{name:"invoice_date",placeholder:"Choose Date"},model:{value:e.invoice.invoice_date,callback:function(t){e.$set(e.invoice,"invoice_date",t)},expression:"invoice.invoice_date"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("invoice_date"),expression:"errors.has('invoice_date')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("invoice_date")))])],1)]),e._v(" "),a("div",{staticClass:"vx-row my-3"},[a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("Invoice Status")]),e._v(" "),a("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{name:"invoice_status",options:["received","pending"]},model:{value:e.invoice.invoice_status,callback:function(t){e.$set(e.invoice,"invoice_status",t)},expression:"invoice.invoice_status"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("status"),expression:"errors.has('status')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("status")))])],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/3 w-full"},[a("label",[e._v("ពិពណ៌នា")]),e._v(" "),a("vs-textarea",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{label:"ពិពណ៌នា",name:"description"},model:{value:e.invoice.description,callback:function(t){e.$set(e.invoice,"description",t)},expression:"invoice.description"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("description"),expression:"errors.has('description')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("description")))])],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/3"},[e._v("\n                            Amount\n                            "),a("span",{staticClass:"text-6xl block"},[e._v("$"+e._s(e.invoice.total_balance))])])]),e._v(" "),a("vs-divider",{attrs:{position:"left"}},[e._v("បញ្ជីទំនិញ")]),e._v(" "),a("table",{staticClass:"vs-table vs-table--tbody-table"},[a("thead",[a("tr",[a("th",[e._v("ល.រ")]),e._v(" "),a("th",[e._v("ឈ្មោះ")]),e._v(" "),a("th",[e._v("ពិពណ៌នា")]),e._v(" "),a("th",[e._v("ចំនួន")]),e._v(" "),a("th",[e._v("តម្លៃលក់")]),e._v(" "),a("th",[e._v("សរុប")]),e._v(" "),a("th")])]),e._v(" "),a("tbody",e._l(e.invoice.items,(function(t,n){return a("tr",{key:n},[a("td",{staticClass:"py-1"},[e._v("\n                                "+e._s(n+1)+"\n                            ")]),e._v(" "),a("td",{attrs:{width:"600"}},[a("q-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{outlined:"",square:"",dense:"","use-input":"","input-debounce":"0",label:"ជ្រើសរើសទំនិញ",options:Object.freeze(e.options),behavior:"dialog",name:"product-"+n,clearable:""},on:{filter:e.filterFn,input:function(a){return e.selectProduct(t.id,n)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n                                                No results\n                                            ")])],1)]},proxy:!0},{key:"option",fn:function(t){return[a("q-item",e._g(e._b({},"q-item",t.itemProps,!1),t.itemEvents),[a("q-item-section",[a("q-item-label",{domProps:{innerHTML:e._s(t.opt.label)}}),e._v(" "),a("q-item-label",{attrs:{caption:""}},[e._v("\n                                                    "+e._s("Unit: "+t.opt.product.unit+" - Brand: "+t.opt.product.brand+" - Inventory Type: "+t.opt.inventory_type)+"\n                                                ")]),e._v(" "),a("q-item-label",[e._v("\n                                                    "+e._s("អ្នកផ្គត់ផ្គង់៖ "+t.opt.supplier.name+" ក្រុមហ៊ុន៖ "+t.opt.supplier.company)+"\n                                                ")]),e._v(" "),a("q-item-label",{attrs:{caption:""}},[e._v("\n                                                    "+e._s("ទំនាក់ទំនង "+t.opt.supplier.contact)+"\n                                                ")])],1)],1),e._v(" "),a("q-separator")]}}],null,!0),model:{value:t.id,callback:function(a){e.$set(t,"id",a)},expression:"tr.id"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("product-"+n),expression:"errors.has(`product-${index}`)"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("product-"+n)))])],1),e._v(" "),a("td",[e._v("\n                                "+e._s(t.description)+"\n                            ")]),e._v(" "),a("td",["service"===t.inventory_type?a("vs-input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{color:"danger",min:"0",name:"qty-"+n},model:{value:t.qty,callback:function(a){e.$set(t,"qty",a)},expression:"tr.qty"}}):e._e(),e._v(" "),"service"!==t.inventory_type?a("vs-input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{color:"success",min:"0",max:t.remain_qty,name:"qty-"+n},model:{value:t.qty,callback:function(a){e.$set(t,"qty",a)},expression:"tr.qty"}}):e._e(),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("qty-"+n),expression:"errors.has(`qty-${index}`)"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("qty-"+n)))])],1),e._v(" "),a("td",[a("vs-input-number",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{color:"danger",min:"0",name:"sale_price-"+n},model:{value:t.sale_price,callback:function(a){e.$set(t,"sale_price",a)},expression:"tr.sale_price"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("sale_price-"+n),expression:"errors.has(`sale_price-${index}`)"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("sale_price-"+n)))])],1),e._v(" "),a("td",[e._v("\n                                "+e._s(t.amount=t.sale_price*t.qty)+"\n                            ")]),e._v(" "),a("td",{staticClass:"py-1"},[a("vs-button",{attrs:{icon:"icon-trash-2",color:"warning","icon-pack":"feather",type:"flat"},on:{click:function(t){return e.removeItemLine(n)}}})],1)])})),0)]),e._v(" "),a("vs-button",{staticClass:"rounded-none my-3",attrs:{icon:"icon-plus","icon-pack":"feather",type:"line"},on:{click:e.addItemLine}},[e._v("បន្ថែមទំនិញ\n                    ")]),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("vs-divider",{attrs:{position:"left"}},[e._v("Payment")]),e._v(" "),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("label",[e._v("ប្រាក់ទិញទំនិញ")]),e._v(" "),a("vs-input-number",{attrs:{color:"warning",min:"0",max:e.invoice.total_balance,label:"ប្រាក់ទិញទំនិញ:"},model:{value:e.invoice.balance,callback:function(t){e.$set(e.invoice,"balance",t)},expression:"invoice.balance"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("label",[e._v("ទឹកប្រាក់ជំពាក់")]),e._v(" "),a("vs-input",{staticClass:"w-full",attrs:{step:"any",readonly:"",type:"number"},model:{value:e.invoice.due_balance=e.invoice.total_balance-e.invoice.balance,callback:function(t){e.$set(e.invoice.due_balance=e.invoice.total_balance-e.invoice,"balance",t)},expression:"invoice.due_balance = invoice.total_balance - invoice.balance"}})],1)]),e._v(" "),a("vs-divider",{attrs:{position:"left"}},[a("vs-checkbox",{model:{value:e.invoice.is_bundle,callback:function(t){e.$set(e.invoice,"is_bundle",t)},expression:"invoice.is_bundle"}},[e._v("ទំនិញដំុ?")])],1),e._v(" "),e.invoice.is_bundle?a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("label",[e._v("តម្លៃទិញ")]),e._v(" "),a("vs-input-number",{attrs:{min:"0",label:"តម្លៃទិញ:"},model:{value:e.invoice.purchase_amount,callback:function(t){e.$set(e.invoice,"purchase_amount",t)},expression:"invoice.purchase_amount"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/2 w-full"},[a("label",[e._v("តម្លៃលក់")]),e._v(" "),a("vs-input-number",{attrs:{min:"0",label:"តម្លៃលក់:"},model:{value:e.invoice.sale_amount,callback:function(t){e.$set(e.invoice,"sale_amount",t)},expression:"invoice.sale_amount"}})],1)]):e._e()],1)]),e._v(" "),a("vs-divider"),e._v(" "),a("div",{staticClass:"flex justify-end btn-group"},[a("vs-button",{attrs:{icon:"icon-edit","icon-pack":"feather",type:"relief"},on:{click:e.updateInvoice}},[e._v("កែប្រែ\n                        ")])],1)],1)],1)],1)],1),e._v(" "),a("add-customer",{ref:"addCustomer"}),e._v(" "),a("add-unit",{ref:"addUnit"}),e._v(" "),a("add-category",{ref:"addCategory"}),e._v(" "),a("add-brand",{ref:"addBrand"})],1)}),[],!1,null,"53f0b8aa",null).exports,D=a("B6ir"),L=a("q+Mi"),A=a("pS5H"),j=a("rdXg"),B=a.n(j);function U(e,t,a,n,i,s,r){try{var o=e[s](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}function E(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var s=e.apply(t,a);function r(e){U(s,n,i,r,o,"next",e)}function o(e){U(s,n,i,r,o,"throw",e)}r(void 0)}))}}var F,H,T={name:"printInvoice",components:{AddSupplier:D.a,AddBrand:_.a,AddCategory:p.a,AddUnit:u.a,flatPickr:v.a,"v-select":f.a,"bar-code":L.a,"money-format":A.a},data:function(){return{dialog:!1,data:{purchase_amount:0,id:null,customer:{name:""},balance:null,due_balance:null,invoice_status:null,invoice_date:null,description:null,items:[]}}},computed:{total_amount:function(){return this.data.items.reduce((function(e,t){return e+parseFloat(t.amount)}),0)}},methods:{_print:(H=E(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelector("#printMe"),a={type:"dataURL"},e.next=4,this.$html2canvas(t,a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(){return H.apply(this,arguments)}),printHtml:(F=E(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._print();case 2:t=e.sent,B()(t,"image");case 4:case"end":return e.stop()}}),e,this)}))),function(){return F.apply(this,arguments)}),show:function(e){var t=this;this.dialog=!0,t.data.id=e.id,t.data.purchase_amount=e.purchase_amount,t.data.balance=e.balance,t.data.due_balance=e.due_balance,t.data.customer=e.customer,t.data.invoice_status=e.invoice_status,t.data.invoice_date=e.date,t.data.description=e.description,t.data.items=[],e.invoice_detail.forEach((function(e,a){t.data.items.push({name:e.purchase_detail.product.name,description:e.purchase_detail.product.description,qty:e.qty,sale_price:e.sale,amount:0,inventory_type:e.inventory_type})}))}}};a("WsGf");function z(e,t,a,n,i,s,r){try{var o=e[s](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,i)}function K(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var s=e.apply(t,a);function r(e){z(s,n,i,r,o,"next",e)}function o(e){z(s,n,i,r,o,"throw",e)}r(void 0)}))}}var M,J={name:"Sale",components:{PrintInvoice:Object(o.a)(T,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("q-card",[a("q-bar",[a("q-space"),e._v(" "),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}},[a("q-tooltip",{attrs:{"content-class":"bg-white text-primary"}},[e._v("Close")])],1)],1),e._v(" "),a("q-card-section",[a("vx-card",{attrs:{"no-shadow":""}},[a("div",{attrs:{id:"printMe"}},[a("img",{staticClass:"mb-base",attrs:{src:"/images/header/invoice-header.png",width:"90%",alt:""}}),e._v(" "),a("table",{attrs:{border:"0"}},[a("tr",[a("td",[e._v("អតិថិជន "),a("br"),e._v("Customer")]),e._v(" "),a("td",[e._v("Invoice Status")]),e._v(" "),a("td",[e._v("លក់ពី "),a("br"),e._v("Sold from")]),e._v(" "),a("td",[e._v("ពិពណ៌នា"),a("br"),e._v("Description")]),e._v(" "),a("td",[e._v("ថ្ងៃខែឆ្នាំលក់​ "),a("br"),e._v("Sold from")]),e._v(" "),a("td",[e._v("Barcode")])]),e._v(" "),a("tr",[a("td",[e._v("\n                                    ឈ្មោះ: "+e._s(e.data.customer.name)),a("br"),e._v("\n                                    ទំនាក់ទំនង: "+e._s(e.data.customer.contact)),a("br")]),e._v(" "),a("td",[e._v(e._s(e.data.invoice_status))]),e._v(" "),a("td",[e._v("Ly put")]),e._v(" "),a("td",[e._v(e._s(e.data.description))]),e._v(" "),a("td",[e._v(e._s(e.data.invoice_date))]),e._v(" "),a("td",{staticClass:"p-2"},[a("bar-code",{attrs:{value:e.data.id,options:{displayValue:!0}}})],1)])]),e._v(" "),a("vs-divider"),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("ល.រ "),a("br"),e._v("No")]),e._v(" "),a("th",[e._v("ឈ្មោះ"),a("br"),e._v("Name")]),e._v(" "),a("th",[e._v("ពិពណ៌នា"),a("br"),e._v("Description")]),e._v(" "),a("th",[e._v("ចំនួន"),a("br"),e._v("Qty")]),e._v(" "),a("th",[e._v("តម្លៃលក់"),a("br"),e._v("Unit Price")]),e._v(" "),a("th",[e._v("សរុប"),a("br"),e._v("Amount")])])]),e._v(" "),a("tbody",e._l(e.data.items,(function(t,n){return a("tr",{key:n},[a("td",{staticClass:"pl-2 print:pl-2"},[e._v("\n                                    "+e._s(n+1)+"\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[e._v("\n                                    "+e._s(t.name)+"\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[e._v("\n                                    "+e._s(t.description)+"\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[e._v("\n                                    "+e._s(t.qty)+"\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},["bundle"!==t.inventory_type?a("money-format",{attrs:{value:parseFloat(t.sale_price),locale:"en","currency-code":"USD"}}):e._e()],1),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},["bundle"!==t.inventory_type?a("money-format",{attrs:{value:parseFloat(t.amount=t.sale_price*t.qty),locale:"en","currency-code":"USD"}}):e._e()],1)])})),0),e._v(" "),!parseFloat(e.data.purchase_amount)>0?a("tfoot",[a("tr",[a("td"),e._v(" "),a("td"),e._v(" "),a("td"),e._v(" "),a("td"),e._v(" "),a("td",{staticClass:"md:text-right"},[e._v("\n                                    សរុប\n                                ")]),e._v(" "),a("td",{staticClass:"pl-2 print:pl-2"},[a("money-format",{attrs:{value:e.total_amount,locale:"en","currency-code":"USD"}})],1)])]):e._e()]),e._v(" "),a("vs-divider"),e._v(" "),a("div",{staticClass:"vx-row",staticStyle:{color:"#246ca8"}},[a("div",{staticClass:"vx-col md:w-1/4 print:w-1/4 w-full"},[a("label",[e._v("ប្រាក់ទិញទំនិញ")]),e._v(" "),a("money-format",{attrs:{value:parseFloat(e.data.balance),locale:"en","currency-code":"USD"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/4 print:w-1/4 w-full"},[a("label",[e._v("ទឹកប្រាក់ជំពាក់")]),e._v(" "),a("money-format",{attrs:{value:parseFloat(e.data.due_balance),locale:"en","currency-code":"USD"}})],1),e._v(" "),a("div",{staticClass:"vx-col md:w-1/4 print:w-1/4 w-full"},[e._v("\n                                អ្នកលក់/Seller "),a("br"),e._v(" "),a("br")]),e._v(" "),a("div",{staticClass:"vx-col md:w-1/4 print:w-1/4 w-full"},[e._v("\n                                អ្នកទិញ/Buyer "),a("br"),e._v(" "),a("br")])])],1),e._v(" "),a("div",{staticClass:"flex justify-end btn-group"},[a("vs-button",{attrs:{icon:"icon-printer","icon-pack":"feather",type:"relief"},on:{click:e.printHtml}},[e._v("បោះពុម្ភ\n                        ")])],1)])],1)],1)],1),e._v(" "),a("add-supplier",{ref:"addSupplier"}),e._v(" "),a("add-unit",{ref:"addUnit"}),e._v(" "),a("add-category",{ref:"addCategory"}),e._v(" "),a("add-brand",{ref:"addBrand"})],1)}),[],!1,null,"1adf321e",null).exports,EditInvoice:O,AddInvoice:q,ShowInvoice:l.a,AddPayment:c},data:function(){return{invoice_id:"",selected_pending:[],selected_received:[]}},created:function(){this.$barcodeScanner.init(this.onBarcodeScanned)},destroyed:function(){this.$barcodeScanner.destroy()},computed:{all_invoices:function(){return this.$store.getters.all_invoice},all_product:function(){return this.$store.getters.all_product},all_purchases:function(){return this.$store.getters.all_purchase},all_invoice_received:function(){return this.all_invoices.filter((function(e){return"received"===e.invoice_status}))},search_all_invoice_received:function(){var e=this;return e.all_invoice_received.filter((function(t){return!e.invoice_id||t.id===parseInt(e.invoice_id)}))},suggestion_all_invoice_received:function(){return this.all_invoice_received.map((function(e){return{id:String(e.id)}}))},all_invoice_pending:function(){return this.all_invoices.filter((function(e){return"pending"===e.invoice_status}))},search_all_invoice_pending:function(){var e=this;return e.all_invoice_pending.filter((function(t){return!e.invoice_id||t.id===parseInt(e.invoice_id)}))},suggestion_all_invoice_pending:function(){return this.all_invoice_pending.map((function(e){return{id:String(e.id)}}))},all_purchase_received:function(){return this.all_purchases.filter((function(e){return"received"===e.purchase_status}))}},methods:{onBarcodeScanned:function(e){var t=window.event;13===t.keyCode&&t.preventDefault(),this.invoice_id=String(parseInt(e))},destroyInvoice:(M=K(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this).$vs.loading(),a=t.selected_pending.map(function(){var e=K(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("destroyInvoice",a.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(a).then((function(){t.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានលុប",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),t.selected_pending=[],t.$vs.loading.close()}));case 5:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})}},Y=Object(o.a)(J,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"flex btn-group"},[a("vs-button",{attrs:{type:"relief","icon-pack":"feather",icon:"icon-plus-square"},on:{click:function(t){return e.$refs.addInvoice.show()}}},[e._v("បន្ថែម")])],1),e._v(" "),a("vs-tabs",[a("vs-tab",{attrs:{label:"Received"}},[a("div",{staticClass:"flex btn-group"},[1===e.selected_received.length&&e.selected_received[0].due_balance>0?a("vs-button",{attrs:{color:"warning",type:"relief","icon-pack":"feather",icon:"icon-dollar-sign"},on:{click:function(t){return e.$refs.addPayment.show(e.selected_received[0])}}},[e._v("Add Payment")]):e._e(),e._v(" "),1===e.selected_received.length?a("vs-button",{attrs:{color:"success",type:"relief","icon-pack":"feather",icon:"icon-printer"},on:{click:function(t){return e.$refs.printInvoice.show(e.selected_received[0])}}},[e._v("បោះពុម្ភ")]):e._e(),e._v(" "),1===e.selected_received.length?a("vs-button",{attrs:{type:"relief","icon-pack":"feather",icon:"icon-eye"},on:{click:function(t){return e.$refs.showInvoice.show(e.selected_received[0])}}},[e._v("បង្ហាញ")]):e._e()],1),e._v(" "),a("vue-instant",{staticClass:"mt-base",attrs:{id:"purchase_rec","suggestion-attribute":"id",suggestions:e.suggestion_all_invoice_received,type:"google"},on:{clear:function(t){e.invoice_id=""}},model:{value:e.invoice_id,callback:function(t){e.invoice_id=t},expression:"invoice_id"}}),e._v(" "),a("vs-table",{attrs:{multiple:"",pagination:"","max-items":"10",search:"",data:e.search_all_invoice_received},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return e._l(n,(function(t,i){return a("vs-tr",{key:i,attrs:{data:t}},[a("vs-td",{attrs:{data:n[i].id}},[e._v("\n                                "+e._s(n[i].id)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].description}},[e._v("\n                                "+e._s(n[i].description)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].customer.name}},[e._v("\n                                "+e._s(n[i].customer.name)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].qty}},[e._v("\n                                "+e._s(n[i].qty)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].balance}},[e._v("\n                                "+e._s(n[i].balance)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].amount}},[e._v("\n                                "+e._s(n[i].amount)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].due_balance}},[e._v("\n                                "+e._s(n[i].due_balance)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].date}},[e._v("\n                                "+e._s(n[i].date)+"\n                            ")])],1)}))}}]),model:{value:e.selected_received,callback:function(t){e.selected_received=t},expression:"selected_received"}},[a("template",{slot:"thead"},[a("vs-th",{attrs:{"sort-key":"id"}},[e._v("ល.រ")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"description"}},[e._v("Description")]),e._v(" "),a("vs-th",[e._v("Customer")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"qty"}},[e._v("QTY")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"balance"}},[e._v("Balance")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"amount"}},[e._v("Amount")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"due_balance"}},[e._v("Due Balance")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"date"}},[e._v("Date")])],1)],2),e._v(" "),a("add-payment",{ref:"addPayment",on:{finished:function(t){e.selected_received=[]}}})],1),e._v(" "),a("vs-tab",{attrs:{label:"Pending"}},[a("div",{staticClass:"flex btn-group"},[1===e.selected_pending.length&&e.selected_pending[0].due_balance>0?a("vs-button",{attrs:{color:"warning",type:"relief","icon-pack":"feather",icon:"icon-dollar-sign"},on:{click:function(t){return e.$refs.addPaymentPending.show(e.selected_pending[0])}}},[e._v("Add Payment")]):e._e(),e._v(" "),1===e.selected_pending.length?a("vs-button",{attrs:{color:"success",type:"relief","icon-pack":"feather",icon:"icon-eye"},on:{click:function(t){return e.$refs.showInvoice.show(e.selected_pending[0])}}},[e._v("បង្ហាញ")]):e._e(),e._v(" "),1===e.selected_pending.length?a("vs-button",{attrs:{type:"relief","icon-pack":"feather",icon:"icon-printer"},on:{click:function(t){return e.$refs.printInvoice.show(e.selected_pending[0])}}},[e._v("បោះពុម្ភ")]):e._e(),e._v(" "),1===e.selected_pending.length?a("vs-button",{attrs:{color:"warning",type:"relief","icon-pack":"feather",icon:"icon-edit"},on:{click:function(t){return e.$refs.editInvoice.show(e.selected_pending[0])}}},[e._v("កែប្រែ")]):e._e(),e._v(" "),e.selected_pending.length?a("vs-button",{attrs:{color:"danger",type:"relief","icon-pack":"feather",icon:"icon-trash-2"},on:{click:e.destroyInvoice}},[e._v("លុប")]):e._e()],1),e._v(" "),a("add-payment",{ref:"addPaymentPending",on:{finished:function(t){e.selected_pending=[]}}}),e._v(" "),a("vue-instant",{staticClass:"mt-base",attrs:{id:"purchase_pen","suggestion-attribute":"id",suggestions:e.suggestion_all_invoice_pending,type:"google"},on:{clear:function(t){e.invoice_id=""}},model:{value:e.invoice_id,callback:function(t){e.invoice_id=t},expression:"invoice_id"}}),e._v(" "),a("vs-table",{attrs:{multiple:"",pagination:"","max-items":"10",search:"",data:e.search_all_invoice_pending},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return e._l(n,(function(t,i){return a("vs-tr",{key:i,attrs:{data:t}},[a("vs-td",{attrs:{data:n[i].id}},[e._v("\n                                "+e._s(n[i].id)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].description}},[e._v("\n                                "+e._s(n[i].description)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].customer.name}},[e._v("\n                                "+e._s(n[i].customer.name)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].qty}},[e._v("\n                                "+e._s(n[i].qty)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].balance}},[e._v("\n                                "+e._s(n[i].balance)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].amount}},[e._v("\n                                "+e._s(n[i].amount)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].due_balance}},[e._v("\n                                "+e._s(n[i].due_balance)+"\n                            ")]),e._v(" "),a("vs-td",{attrs:{data:n[i].date}},[e._v("\n                                "+e._s(n[i].date)+"\n                            ")])],1)}))}}]),model:{value:e.selected_pending,callback:function(t){e.selected_pending=t},expression:"selected_pending"}},[a("template",{slot:"thead"},[a("vs-th",{attrs:{"sort-key":"id"}},[e._v("ល.រ")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"description"}},[e._v("Description")]),e._v(" "),a("vs-th",[e._v("Customer")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"qty"}},[e._v("QTY")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"balance"}},[e._v("Balance")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"amount"}},[e._v("Amount")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"due_balance"}},[e._v("Due Balance")]),e._v(" "),a("vs-th",{attrs:{"sort-key":"date"}},[e._v("Date")])],1)],2)],1)],1),e._v(" "),a("show-invoice",{ref:"showInvoice"}),e._v(" "),a("print-invoice",{ref:"printInvoice"}),e._v(" "),a("add-invoice",{ref:"addInvoice"}),e._v(" "),a("edit-invoice",{ref:"editInvoice",on:{finished:function(t){e.selected_pending=[]}}})],1)}),[],!1,null,"6d9ae12f",null);t.default=Y.exports},i6E6:function(e,t,a){var n=a("VLXm");"string"==typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,i);n.locals&&(e.exports=n.locals)},yo3J:function(e,t,a){"use strict";var n={name:"addUnit",data:function(){return{unit:""}},methods:{show:function(){this.$modal.show("add-unit")},storeUnit:function(){var e=this;this.$validator.validateAll().then((function(t){t?(e.$vs.loading(),e.$store.dispatch("storeUnit",{name:e.unit}).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField()):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.unit=""}}},i=a("KHd+"),s=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal",{attrs:{height:"auto",scrollable:!0,pivotY:.2,clickToClose:!1,name:"add-unit"}},[a("div",{staticClass:"flex justify-end"},[a("i",{staticClass:"vs-icon vs-popup--close material-icons text-warning",staticStyle:{background:"rgb(255, 255, 255)"},on:{click:function(t){return e.$modal.hide("add-unit")}}},[e._v("close")])]),e._v(" "),a("vx-card",{attrs:{"no-shadow":""}},[a("div",{staticClass:"vx-row mb-10"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{"label-placeholder":"ឈ្មោះ",name:"unit"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.storeUnit(t)}},model:{value:e.unit,callback:function(t){e.unit=t},expression:"unit"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("unit"),expression:"errors.has('unit')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("unit")))])],1)])],1)}),[],!1,null,"da88d7b4",null);t.a=s.exports}}]);